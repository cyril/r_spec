#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require_relative File.join("..", "lib", "r_spec")

Dir[File.join(Dir.pwd, "spec", "**", "*.rb")].each do |fname|
  require_relative fname
end

RSpec::Test.constants.map { |name| RSpec::Test.const_get(name) }.each do |c|
  testset = c.new

  testset.public_methods(false).each do |public_method|
    result = testset.public_send(public_method)

    if result.passed?
      puts result.colored_string
    else
      warn result.colored_string
      exit(false)
    end
  end
end
